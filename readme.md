_H(igh-throughput) A(utomated) M(olecular) R(eplacement)_

_Reference_

TBD

_Installation_

Currently HAMR only supports Mac OS with Applie silicon

You must specify the location of two executables before running HAMR:

- A phaser executable (stored in environment variable $HAMR_PHASER_EXEC)

  For ccp4 mac users, this is usually found in /Applications/ccp4-X/bin/phaser by default where X is the version of ccp4 you have installed

- Phenix setup script (stored in environment variable $HAMR_PHENIX_SETUP_SH)

  For mac users, this is usually found in /usr/local/phenix-XXXX/phenix_env.sh by default where XXXX is the version of phenix you have installed

- Additionally, you must have Python v3.13 installed

_Usage_

- The binary executable with all other packages is included in the dist folder (./dist/hamr), all you must supply is a settings file in JSON format. An example is included in this repository (./settings_template.json). You must provide this as the only argument to the main entry point of the program. (e.g. ./hamr ./demo/settings_graz_demo.json)

* This JSON can be used as a template for use with CCP4 MTZ formatted merged reflections with structures specified as a SMILES file and the corresponding refinement restriction library.
* Below is some more documentation on what each field does and how you can modify it:
  - input_smiles_path: location of input SMILES structure (e.g. your_structure.smi). Pay attention to stereochemistry, HAMR will proceed as normal without stereochemistry specified and assigns unassigned stereocenters randomly.
  - output_path: string - location of where to store temporary files and also the final refined structures. (~200MB per HAMR run is needed)
  - conformer_prefix: string - what stored files should be named with (cosmetic only)
  - conforge_max_time: integer - maximum time before exiting CONFORGE conformer generation in seconds, which will cause entire HAMR run to fail (normally this only takes 10-15 minutes)
  - conforge_min_rmsd: float - minimum RMSD difference between conformers generated by CONFORGE
  - conforge_energy_window: integer - maximum energy difference between conformers generated by CONFORGE (kcal/mol)
  - conforge_max_num_confs: integer - maximum number of conformers to be output by CONFORGE
  - input_mtz: string - location of CCP4 MTZ formatted merged reflections
  - should_log_phaser: boolean - if true will log all output of all PHASER runs (useful for debugging), will dramatically increase disk space used by HAMR
  - restraint_cif: string - location of monomer library (.cif) with restraints for small molecule needed for refinement. PHENIX's eLBoW was used to generate this library in our development.
  - smiles_string: string - similar to input_smiles_path, but instead specifying the SMILES string directly, rather than path to the .smi file
  - refinement_columns: string - comma-seperated pair of strings for the two columns which are used for the PHENIX refine process (no spaces, first column is measured value, second column is sigma of that measured value)
  - r_factor_columns: list - contains labels for columns are used to calculate r-factors directly for modified conformers. (similar to refinement_columns, first column is measured value, second column is sigma of that measured value).
  - num_refine_cycles: string - how many PHENIX refinement cycles should be performed on each conformer at the end of each HAMR trial
  - angle_step: integer - determines how fine each dihedral angle is sampled (e.g. if angle_step == 10, then each dihedral angle is tested at +10, +20, +30,..., +350 degrees)
  - num_to_persist: integer - determines the number of top solutions at the end of each cycle to be used in the next cycle, also determines how many final solutions are refined
  - fraction_to_phase: float - the fraction of total conformers generated to process with PHASER during each cycle, in order of best to worst r-factor.
  - faulty_conformer_rmsd_cutoff: integer - currently not implemented.
  - r_free_fraction: string - fraction of intensities to be reserved for r-free calculations during final refinement
  - should_force_trans_amides: boolean - determines if dihedral angles which contain amides should be forced into trans configuration (180 degree dihedral) or should be fully optimized at every dihedral angle.

_Demo_

- A settings JSON file that contains all the necessary parameters for HAMR to solve the structure of grazoprevir at 0.99 A resolution is included in the ./demo folder. The requisite reflections, cif restrictions, and smiles file are included in this ./demo folder as well.

_Contact_
if you come across a bug or issue with the code, or just have some suggestions, my email is athib27@gmail.com
