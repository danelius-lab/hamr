_H(igh-throughput) A(utomated) M(olecular) R(eplacement)_

_Reference_\
TBD

_Installation_\
You must specify the location of two files:

- A phaser executable (stored in environment variable $HAMR_PHASER_EXEC)\
  For ccp4 mac users, this is found in /Applications/ccp4-X/bin/phaser by default where X is the version of ccp4 you have installed\
- Phenix setup script (stored in environment variable $HAMR_PHENIX_SETUP_SH)\
  For mac users, this is found in /usr/local/phenix-XXXX/phenix_env.sh by default where XXXX is the version of phenix you have installed

_Usage_\

- After installing via pip, you must specify settings in a JSON file, which an example is included in this repo (./settings_demo.json), and provide this as the only argument to the main entry point of the program.
  (.e.g python3.13 main.py ./demos/settings_demo.json)

* This JSON contains all the necessary parameters for the program to solve the structure of grazoprevir at 0.99 A resolution, including the provided reflections and SMILES file.
* This JSON can be used as a template for use with other CCP4 MTZ formatted reflections and structures specified as a SMILES file and a smiles string.
* Below is some more documentation on what each field does and how you can modify it:
  - input_smiles_path: location of input SMILES structure (e.g. your_structure.smi). Pay attention to stereochemistry, this program will proceed as normal without stereochemistry specified and assigns unassigned stereocenters randomly.
  - output_path: location of where to store temporary files and also the final refined structures. (~200MB per HAMR run is needed)
  - conformer_prefix: what stored files should be named with (cosmetic only)
  - conforge_max_time: maximum time before exiting conforge conformer generation in seconds, which will cause entire HAMR run to fail (normally this only takes 10-15 minutes)
  - conforge_min_rmsd: minimum RMSD between conformers generated by CONFORGE
  - conforge_energy_window: maximum energy difference between conformers generated by CONFORGE
  - conforge_max_num_confs: maximum number of conformers to be output by CONFORGE
  - input_mtz: location of CCP4 MTZ formatted merged reflections
  - should_log_phaser: boolean that if true will log all output of all PHASER runs (useful for debugging), will dramatically increase disk space used by HAMR
  - restraint_cif: location of monomer library (.cif) with restraints for small molecule needed for refinement. PHENIX's eLBoW was used to generate this library in our development.
  - smiles_string: similar to input_smiles_path, but instead specifying the string directly, rather than path to the .smi file
  - refinement_columns: comma-seperated pair of strings for the two columns which are used for the PHENIX refine process (no spaces, first column is measured value, second column is sigma of that measured value)
  - r_factor_columns: array of what columns are used to calculate r-factors directly for modified conformers. (similar to above, first column is measured value, second column is sigma of that measured value).
  - num_refine_cycles: string - how many PHENIX refinement cycles should be performed on each conformer at the end of each HAMR trial
  - angle_step: integer - determines how fine each dihedral angle is sampled (e.g. if angle_step == 10, then each dihedral angle is tested at +10, +20, +30,...+350 degrees)
  - num_to_persist: integer - determines the number of top solutions at the end of each cycle to be used in the next cycle, also determines how many final solutions are refined
  - faulty_conformer_rmsd_cutoff: integer - currently not working...
  - r_free_fraction: string - fraction of intensities to be reserved for r_free calculations during final refinement
  - should_force_trans_amides: boolean - determines if dihedral angles which contain amides shouuld be forced into trans configuration (180 degree dihedral) or should be fully optimized at every dihedral angle.

_Demos_\
which to include?\
grazoprevir - yes, its fast\
paritaprevir_a - no, its slow\
paritaprevir_b - maybe, kinda slow\
corilagin - also fast, but need to deposit first?\
resolutions??

_Contact_\
if you come across a bug or issue with the code, or just have some suggestions, my email is athib004@ucr.edu
